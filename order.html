<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Page - foodpanda</title>
  <link rel="stylesheet" href="css files/style.css">
  <link rel="shortcut icon" href="./assests/icons/favicon-icon.webp" type="image/x-icon">
      <script src="https://smtpjs.com/v3/smtp.js"></script>      
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" integrity="sha512-5A8nwdMOWrSz20fDsjczgUidUBR8liPYU+WymTZP1lmY9G6Oc7HlZv156XqnsgNUzTyMefFTcsFH/tnJE/+xBg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZmK9OfevYSLVQaR5H1+f+zJwYpOohg5V9zzTtmI3UksdQRVvoxMfooAo0vw5qX2hMA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/                                                   6.4.0/css/brands.min.css" integrity="sha512-7rSLT8C3hBqk1bKp2aH2XpG6iG7fXUeJHqZ9LP+XcUQy9cZl5V2FfXxDzY0sM8Qm8P3r0iK4n5V0L2VY3Qm6UQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />   
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/fontawesome.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZmK9OfevYSLVQaR5H1+f+zJwYpOohg5V9zzTtmI3UksdQRVvoxMfooAo0vw5qX2hMA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/       
6.4.0/css/light.min.css" integrity="sha512-+l9QpIMpX2aH+Ykz8Kc6s0m9A7rT3gkX7+5b5H1+f+zJwYpOohg5V9zzTtmI3UksdQRVvoxMfooAo0vw5qX2hMA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
<div id="header"></div>

  <main>
    <section class="order-container">
      <div class="product-image">
        <img id="product-image" src="" alt="Product">
      </div>

      <div class="product-details">
        <h2 id="product-name"></h2>
        <p id="product-description"></p>
        <p class="price"><em>Price: Rs <span id="product-price"></span> </em></p>

        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" value="1" min="1">

        <button id="add-to-cart">Add to Cart</button>
      </div>
    </section>
  </main>
  <script src="js files/auth.js"></script>
  <script src="js files/app.js"></script>
  <script src="js files/order.js"></script>
<script>
  fetch("header.html")
    .then(res => res.text())
    .then(data => {
      document.getElementById("header").innerHTML = data;

      if (typeof initAuth === "function") {
        initAuth();
      }
    });
    document.getElementById("add-to-cart").addEventListener("click", () => {
  const product = JSON.parse(localStorage.getItem("selectedProduct"));
  const quantity = parseInt(document.getElementById("quantity").value);

  if(product) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    // Check if product already exists in cart
    const existingIndex = cart.findIndex(item => item.id === product.id);
    if(existingIndex >= 0){
      cart[existingIndex].quantity += quantity;
    } else {
      cart.push({...product, quantity: quantity});
    }

    localStorage.setItem("cart", JSON.stringify(cart));

    // Redirect to cart page
    window.location.href = "cart.html";
  }
});

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
